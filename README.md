
# Grant

[![npm-version]][npm] [![travis-ci]][travis] [![coveralls-status]][coveralls]<a href="https://communityinviter.com/apps/koa-js/koajs" rel="KoaJs Slack Community">![KoaJs Slack](https://img.shields.io/badge/Koa.Js-Slack%20Channel-Slack.svg?longCache=true&style=for-the-badge)</a>


## 170+ Supported Providers / [OAuth Playground][grant-oauth]

[`23andme`](https://api.23andme.com) | [`500px`](https://github.com/500px/api-documentation) | [`acton`](https://developer.act-on.com) | [`acuityscheduling`](https://developers.acuityscheduling.com) | [`aha`](https://www.aha.io/api) | [`amazon`](https://login.amazon.com/documentation) | [`angellist`](https://angel.co/api) | [`arcgis`](https://developers.arcgis.com) | [`asana`](https://asana.com/developers) | [`assembla`](http://api-docs.assembla.cc/) | [`auth0`](https://auth0.com/docs) | [`authentiq`](https://www.authentiq.com/developers) | [`axosoft`](http://developer.axosoft.com) | [`baidu`](http://developer.baidu.com/ms/oauth) | [`basecamp`](https://github.com/basecamp/bcx-api) | [`battlenet`](https://dev.battle.net) | [`beatport`](https://oauth-api.beatport.com) | [`bitbucket`](https://developer.atlassian.com/bitbucket/api/2/reference/) | [`bitly`](https://dev.bitly.com) | [`box`](https://developer.box.com) | [`buffer`](https://dev.buffer.com) | [`campaignmonitor`](https://www.campaignmonitor.com/api) | [`cheddar`](https://cheddarapp.com/developer) | [`clio`](http://api-docs.clio.com) | [`coinbase`](https://developers.coinbase.com) | [`concur`](https://developer.concur.com) | [`constantcontact`](https://developer.constantcontact.com) | [`coursera`](https://building.coursera.org) | [`dailymile`](https://www.dailymile.com/api/documentation) | [`dailymotion`](https://developer.dailymotion.com) | [`deezer`](https://developers.deezer.com) | [`delivery`](https://developers.delivery.com) | [`deputy`](https://www.deputy.com/api-doc/) | [`deviantart`](https://www.deviantart.com/developers/) | [`digitalocean`](https://developers.digitalocean.com) | [`discogs`](https://www.discogs.com/developers/) | [`discord`](https://discordapp.com/developers/docs/intro) | [`disqus`](https://disqus.com/api/docs) | [`docusign`](https://docs.docusign.com) | [`dribbble`](https://developer.dribbble.com) | [`dropbox`](https://www.dropbox.com/developers) | [`ebay`](https://go.developer.ebay.com) | [`echosign`](https://secure.echosign.com/public/docs/restapi/v3) | [`ecwid`](https://developers.ecwid.com) | [`edmodo`](https://partnerships.edmodo.com) | [`egnyte`](https://developers.egnyte.com) | [`etsy`](https://www.etsy.com/developers) | [`eventbrite`](https://www.eventbrite.com/developer/v3/) | [`evernote`](https://dev.evernote.com) | [`everyplay`](https://developers.everyplay.com) | [`eyeem`](https://github.com/eyeem/Public-API) | [`facebook`](https://developers.facebook.com) | [`familysearch`](https://www.familysearch.org/developers/) | [`feedly`](https://developer.feedly.com) | [`fitbit`](https://dev.fitbit.com) | [`flattr`](http://developers.flattr.net) | [`flickr`](https://www.flickr.com/services) | [`flowdock`](https://www.flowdock.com/api) | [`fluidsurveys`](http://docs.fluidsurveys.com) | [`formstack`](https://developers.formstack.com) | [`foursquare`](https://developer.foursquare.com) | [`freeagent`](https://dev.freeagent.com) | [`freshbooks`](https://www.freshbooks.com/developers) | [`geeklist`](http://hackers.geekli.st) | [`genius`](https://docs.genius.com) | [`getbase`](https://developers.getbase.com) | [`getpocket`](https://getpocket.com/developer) | [`gitbook`](https://developer.gitbook.com) | [`github`](https://developer.github.com) | [`gitlab`](https://docs.gitlab.com/ce/api/) | [`gitter`](https://developer.gitter.im) | [`goodreads`](https://www.goodreads.com/api) | [`google`](https://developers.google.com) | [`groove`](https://www.groovehq.com/docs) | [`gumroad`](https://gumroad.com/api) | [`harvest`](https://help.getharvest.com/api-v2/) | [`hellosign`](https://www.hellosign.com/api) | [`heroku`](https://devcenter.heroku.com/categories/platform-api) | [`homeaway`](https://www.homeaway.com/platform) | [`iconfinder`](https://developer.iconfinder.com) | [`idme`](https://developer.id.me) | [`idonethis`](https://i-done-this.readme.io/docs) | [`imgur`](https://apidocs.imgur.com) | [`infusionsoft`](https://developer.infusionsoft.com) | [`instagram`](https://instagram.com/developer) | [`intuit`](https://developer.intuit.com) | [`jamendo`](https://devportal.jamendo.com/) | [`jawbone`](https://jawbone.com/up/developer) | [`jumplead`](https://developer.jumplead.com) | [`kakao`](https://developers.kakao.com) | [`letsfreckle`](https://developer.letsfreckle.com) | [`linkedin`](https://developer.linkedin.com) | [`live`](https://msdn.microsoft.com/en-us/library/hh243647.aspx) | [`lyft`](https://developer.lyft.com) | [`mailchimp`](https://developer.mailchimp.com) | [`mailup`](http://help.mailup.com/display/mailupapi/REST+API) | [`mapmyfitness`](https://developer.underarmour.com) | [`medium`](https://developers.medium.com) | [`meetup`](https://www.meetup.com/meetup_api/) | [`microsoft`](https://developer.microsoft.com/en-us/graph) | [`mixcloud`](https://www.mixcloud.com/developers) | [`mixer`](https://dev.mixer.com) | [`moves`](https://dev.moves-app.com) | [`moxtra`](https://developer.moxtra.com) | [`mydigipass`](https://developer.mydigipass.com) | [`myob`](http://developer.myob.com) | [`nest`](https://developers.nest.com) | [`nylas`](https://docs.nylas.com) | [`okta`](https://developer.okta.com/) | [`openstreetmap`](https://wiki.openstreetmap.org/wiki/API_v0.6) | [`optimizely`](https://developers.optimizely.com) | [`patreon`](https://docs.patreon.com) | [`paypal`](https://developer.paypal.com) | [`pinterest`](https://developers.pinterest.com) | [`plurk`](https://www.plurk.com/API) | [`podio`](https://developers.podio.com) | [`producteev`](https://www.producteev.com/api/doc) | [`producthunt`](https://api.producthunt.com/v1/docs) | [`projectplace`](https://service.projectplace.com/apidocs) | [`pushbullet`](https://docs.pushbullet.com) | [`ravelry`](https://www.ravelry.com/api) | [`redbooth`](https://redbooth.com/api) | [`reddit`](https://www.reddit.com/dev/api) | [`runkeeper`](https://runkeeper.com/developer/healthgraph/) | [`salesforce`](https://developer.salesforce.com) | [`shoeboxed`](https://github.com/Shoeboxed/api) | [`shopify`](https://developers.shopify.com) | [`skyrock`](http://www.skyrock.com/developer) | [`slack`](https://api.slack.com) | [`slice`](https://developer.slice.com) | [`smartsheet`](https://smartsheet-platform.github.io/api-docs) | [`smugmug`](https://api.smugmug.com) | [`socialpilot`](https://developer.socialpilot.co) | [`socrata`](https://dev.socrata.com) | [`soundcloud`](https://developers.soundcloud.com) | [`spotify`](https://developer.spotify.com) | [`square`](https://squareup.com/developers) | [`stackexchange`](https://api.stackexchange.com) | [`stocktwits`](https://api.stocktwits.com/developers) | [`stormz`](https://developer.stormz.me) | [`strava`](https://developers.strava.com) | [`stripe`](https://stripe.com/docs) | [`surveygizmo`](https://apihelp.surveygizmo.com) | [`surveymonkey`](https://developer.surveymonkey.com) | [`thingiverse`](https://www.thingiverse.com/developers) | [`ticketbud`](https://api.ticketbud.com) | [`timelyapp`](https://dev.timelyapp.com) | [`todoist`](https://developer.todoist.com) | [`trakt`](https://docs.trakt.apiary.io) | [`traxo`](https://developer.traxo.com) | [`trello`](https://developers.trello.com) | [`tripit`](https://www.tripit.com/developer) | [`tumblr`](https://www.tumblr.com/docs/en/api/v2) | [`twitch`](https://dev.twitch.tv) | [`twitter`](https://developer.twitter.com) | [`typeform`](https://developer.typeform.com) | [`uber`](https://developer.uber.com) | [`underarmour`](https://developer.underarmour.com) | [`unsplash`](https://unsplash.com/documentation) | [`upwork`](https://developers.upwork.com) | [`uservoice`](https://developer.uservoice.com) | [`vend`](https://developers.vendhq.com) | [`venmo`](https://developers.braintreepayments.com/guides/venmo/overview/) | [`verticalresponse`](http://developers.verticalresponse.com) | [`viadeo`](https://partners.viadeo.com) | [`vimeo`](https://developer.vimeo.com) | [`visualstudio`](https://docs.microsoft.com/en-us/vsts/integrate/get-started/authentication/oauth?view=vsts) | [`vk`](https://vk.com/dev) | [`weekdone`](https://weekdone.com/developer) | [`weibo`](http://open.weibo.com) | [`withings`](https://developer.health.nokia.com/api) | [`wordpress`](https://developer.wordpress.com) | [`wrike`](https://developers.wrike.com) | [`xero`](https://developer.xero.com) | [`xing`](https://dev.xing.com) | [`yahoo`](https://developer.yahoo.com) | [`yammer`](https://developer.yammer.com/docs) | [`yandex`](https://tech.yandex.com) | [`zendesk`](https://developer.zendesk.com)


## Table of Contents

- [Providers][grant]
- **Middleware**
  - [Express][express]
  - [Koa][koa]
  - [Hapi][hapi]
  - [Alternative Require][alternative-require]
  - [Path Prefix][path-prefix]
  - [Reserved Routes][reserved-routes]
- **Configuration**
  - [Basics][configuration]
  - [Redirect URL][redirect-url]
  - [Static Overrides][static-overrides]
  - [Dynamic Override][dynamic-override]
- **Advanced Configuration**
  - [Custom Parameters][custom-parameters]
  - [Custom Providers][custom-providers]
  - [Development Environments][development-environments]
  - [Programmatic Access][programmatic-access]
  - [Sandbox Redirect URI][sandbox-redirect-uri]
  - [Quirks][quirks]
- **[Response Data][response-data]**
- Misc
  - [Typical Flow][typical-flow]
  - [Get User Profile][get-user-profile]
- [Examples][grant-examples]


## Express

```bash
npm install grant-express
```

```js
var express = require('express')
var session = require('express-session')
var grant = require('grant-express')

var app = express()
// REQUIRED: any session store - see /examples/express-session-stores
app.use(session({secret: 'grant'}))
// mount grant
app.use(grant({/*configuration - see below*/}))
```


## Koa

```bash
npm install grant-koa
```

```js
var Koa = require('koa')
var session = require('koa-session')
var mount = require('koa-mount')
var grant = require('grant-koa')

var app = new Koa()
// REQUIRED: any session store - see /examples/koa-session-stores
app.keys = ['grant']
app.use(session(app))
// mount grant
app.use(mount(grant({/*configuration - see below*/})))
```


## Hapi

```bash
npm install grant-hapi
```

```js
var Hapi = require('hapi')
var yar = require('yar')
var grant = require('grant-hapi')

var server = new Hapi.Server()
server.register([
  // REQUIRED: any session store - see /examples/hapi-session-stores
  {plugin: yar, options: {cookieOptions: {password: 'grant', isSecure: false}}},
  // mount grant
  {plugin: grant(), options: {/*configuration - see below*/}}
])
```


## Alternative Require

Alternatively you can require Grant directly *(each pair is identical)*:

```js
// Express
var Grant = require('grant-express')
var Grant = require('grant').express()
// Koa
var Grant = require('grant-koa')
var Grant = require('grant').koa()
// Hapi
var Grant = require('grant-hapi')
var Grant = require('grant').hapi()
```


## Path Prefix

You can mount Grant under specific path prefix:

```js
// Express
app.use('/path/prefix', grant({config}))
// Koa
app.use(mount('/path/prefix', grant({config})))
// Hapi
server.register([{plugin: grant({config}), routes: {prefix: '/path/prefix'}}])
```

In this case it is required to specify the path prefix using the `path` configuration option for the server key:

```js
{
  "server": {
    "protocol": "...",
    "host": "...",
    "path": "/path/prefix"
  }
}
```

Lastly that path prefix should be specified in your OAuth application's redirect URL as well:

```
[protocol]://[host][path]/connect/[provider]/callback
```

In case you want your callback routes prefixed, set them accordingly:

```js
{
  "facebook": {
    "callback": "/path/prefix/handle_facebook_callback"
  }
}
```


## Reserved Routes

```
/connect/:provider/:override?
/connect/:provider/callback
```


## Configuration

```js
{
  "server": {
    "protocol": "http",
    "host": "localhost:3000",
    "callback": "/callback",
    "transport": "session",
    "state": true
  },
  "provider1": {
    "key": "...",
    "secret": "...",
    "scope": ["scope1", "scope2", ...],
    "callback": "/provider1/callback"
  },
  "provider2": {...},
  ...
}
```

- **server** - configuration about your server
  - **protocol** - either `http` or `https`
  - **host** - your server's host name `localhost:3000` | `dummy.com:5000` | `mysite.com` ...
  - **path** - path prefix to use for the Grant middleware *(defaults to empty string if omitted)*
  - **callback** - common callback route for all providers in your config `/callback` | `/done` ...
  - **transport** - transport to use to deliver the response data in your final callback route `querystring` | `session` *(defaults to querystring if omitted)*
  - **state** - generate random state string on each authorization attempt `true` | `false` *(OAuth2 only, defaults to false if omitted)*
- **provider1** - any [supported provider][grant] `facebook` | `twitter` ...
  - **key** - `consumer_key` or `client_id` of your OAuth app
  - **secret** - `consumer_secret` or `client_secret` of your OAuth app
  - **scope** - array of OAuth scopes to request
  - **callback** - specific callback route to use for this provider *(overrides the global one specified under the `server` key)*
  - **custom_params** - custom authorization parameters *(see the [Custom Parameters][custom-parameters] section)*

> Additionally any of the [reserved keys][reserved-keys] can be overriden for a provider.


## Redirect URL

For `redirect` URL of your OAuth application you should **always** use this format:

```
[protocol]://[host]/connect/[provider]/callback
```

Where `protocol` and `host` should match the ones from which you initiate the OAuth flow, and `provider` is the provider's name from the list of [supported providers][grant].

This `redirect` URL is used internally by Grant. You will receive the [response data][response-data] from the OAuth flow inside the route specified in the `callback` key of your Grant configuration.

> See the [Path Prefix][path-prefix] section on how to configure the redirect URL when using the `path` configuration option.


## Static Overrides

You can add arbitrary `{object}` keys inside your provider's configuration to create sub configurations that override the *global* settings for that provider:

```js
// navigate to /connect/facebook
"facebook": {
  "key": "...",
  "secret": "...",
  // by default request publish permissions
  "scope": ["publish_actions", "publish_stream"],
  // set specific callback route on your server for this provider
  "callback": "/facebook/callback",
  // navigate to /connect/facebook/groups
  "groups": {
    // request only group permissions
    "scope": ["user_groups", "friends_groups"]
  },
  // navigate to /connect/facebook/pages
  "pages": {
    // request only page permissions
    "scope": ["manage_pages"],
    // additionally use specific callback route on your server for this override
    "callback": "/facebook_pages/callback"
  }
}
```

> The custom key names must be different from the [reserved ones][reserved-keys].


## Dynamic Override

Additionally you can make a `POST` request to the `/connect/:provider/:override?` route to override your provider's configuration dynamically on each request:

```html
<form action="/connect/facebook" method="post" accept-charset="utf-8">
  <input type="checkbox" name="scope" value="user_birthday" /> user_birthday
  <input type="checkbox" name="scope" value="user_hometown" /> user_hometown
  <input type="checkbox" name="scope" value="user_location" /> user_location
  <button>submit</button>
</form>
```

Keep in mind that in this case you'll have to mount the `body-parser` middleware for Express and Koa before mounting Grant:

```js
// express
var parser = require('body-parser')
app.use(parser.urlencoded({extended: true}))
app.use(grant({config}))
// koa
var parser = require('koa-bodyparser')
app.use(parser())
app.use(mount(grant({config})))
```

Alternatively you can make a `GET` request to the `/connect/:provider/:override?` route:

```js
https://mywebsite.com/connect/facebook?scope=user_photos%2Cuser_videos
```


## Custom Parameters

Some providers may employ custom authorization parameters outside of the specified ones in the [configuration][configuration] section. You can pass those custom parameters using the `custom_params` option:

```js
"google": {
  "custom_params": {"access_type": "offline"}
},
"reddit": {
  "custom_params": {"duration": "permanent"}
},
"trello": {
  "custom_params": {"name": "my app", "expiration": "never"}
}
```

> Additionally any custom parameter that is not a [reserved key][reserved-keys], and is listed under the `custom_parameters` array for that provider, can be defined along with the rest of the options.

> Refer to the provider's OAuth documentation, and the Grant's [OAuth configuration][oauth-config] *(search for `custom_parameters`)*.


## Custom Providers

In case you have a private OAuth provider that you don't want to be part of the [officially supported][oauth-config] ones, you can define it in your configuration by adding a custom key for it.

In this case you have to specify all of the required provider keys by yourself:

```js
{
  "server": {
    "protocol": "https",
    "host": "mywebsite.com"
  },
  "mywebsite": {
    "authorize_url": "https://mywebsite.com/authorize",
    "access_url": "https://mywebsite.com/token",
    "oauth": 2,
    "key": "[CLIENT_ID]",
    "secret": "[CLIENT_SECRET]",
    "scope": ["read", "write"]
  }
}
```

> Refer to the Grant's [OAuth configuration][oauth-config] to see how various providers are configured.


## Development Environments

You can easily configure different development environments:

```js
{
  "development": {
    "server": {"protocol": "http", "host": "dummy.com:3000"},
    "facebook": {
      "key": "development OAuth app credentials",
      "secret": "development OAuth app credentials"
    },
    "twitter": {...}, ...
  },
  "staging": {
    "server": {"protocol": "https", "host": "staging.mywebsite.com"},
    "facebook": {
      "key": "staging OAuth app credentials",
      "secret": "staging OAuth app credentials"
    },
    "twitter": {...}, ...
  },
  "production": {
    "server": {"protocol": "https", "host": "mywebsite.com"},
    "facebook": {
      "key": "production OAuth app credentials",
      "secret": "production OAuth app credentials"
    },
    "twitter": {...}, ...
  }
}
```

Then you can pass the environment flag:

```bash
NODE_ENV=production node app.js
```

And use it in your application:

```js
var config = require('./config.json')
var grant = new Grant(config[process.env.NODE_ENV || 'development'])
```


## Programmatic Access

Once you initialize a new instance of Grant:

```js
var grant = new Grant(require('./config'))
```

You get a special `config` property attached to that instance. It contains the generated configuration data for all of the providers defined in your config file.

> In case of dynamic access to a non pre-configured provider, it is automatically added to the `config` list on first access to the `/connect/:provider` route.


## Sandbox Redirect URI

Very rarely you may need to override the default `redirect_uri` that Grant generates for you.

For example Feedly supports only `http://localhost` as redirect URL of their Sandbox OAuth application, and it won't allow the `http://localhost/connect/feedly/callback` path:

```js
"feedly": {
  "redirect_uri": "http://localhost"
}
```

In case you override the `redirect_uri` in your config, you'll have to redirect the user to the `[protocol]://[host]/connect/[provider]/callback` route that Grant uses to execute the last step of the OAuth flow:

```js
var qs = require('querystring')

app.get('/', (req, res) => {
  if (process.env.NODE_ENV === 'development' &&
      req.session.grant &&
      req.session.grant.provider === 'feedly' &&
      req.query.code
  ) {
    res.redirect('/connect/' + req.session.grant.provider + '/callback?'
      + qs.stringify(req.query))
  }
})
```

After that you will receive the [Response Data][response-data] from the OAuth flow inside the route specified in the `callback` key of your configuration.


## Quirks


#### Subdomain

Some providers require you to set your company name or server region as *subdomain* in the OAuth URLs. You can set that value through the `subdomain` option:

```js
"shopify": {
  "subdomain": "mycompany"
},
"battlenet": {
  "subdomain": "us"
}
```

Then Grant will generate the correct OAuth URLs:

```js
"shopify": {
  "authorize_url": "https://mycompany.myshopify.com/admin/oauth/authorize",
  "access_url": "https://mycompany.myshopify.com/admin/oauth/access_token"
},
"battlenet": {
  "authorize_url": "https://us.battle.net/oauth/authorize",
  "access_url": "https://us.battle.net/oauth/token"
}
```

> Alternatively you can override the entire `request_url`, `authorize_url` and `access_url` in your configuration.


#### Sandbox URLs

Some providers may have *sandbox* URLs for testing. To use them just override the entire `request_url`, `authorize_url` and `access_url` in your configuration *(notice the `sandbox` bits)*:

```js
"paypal": {
  "authorize_url": "https://www.sandbox.paypal.com/webapps/auth/protocol/openidconnect/v1/authorize",
  "access_url": "https://api.sandbox.paypal.com/v1/identity/openidconnect/tokenservice"
},
"evernote": {
  "request_url": "https://sandbox.evernote.com/oauth",
  "authorize_url": "https://sandbox.evernote.com/OAuth.action",
  "access_url": "https://sandbox.evernote.com/oauth"
}
```


#### Ebay

Set the redirect URL of your OAuth app as usual `[protocol]://[host]/connect/ebay/callback`. Then Ebay will generate a special string called *RuName (eBay Redirect URL name)* that you need to set as `redirect_uri` in Grant:

```js
"ebay": {
  "redirect_uri": "[RUNAME]"
}
```


#### Flickr, Optimizely

Flickr uses a custom authorization parameter to pass its scopes called `perms`, and Optimizely uses `scopes`. However you should use the regular `scope` option in your configuration:

```js
"flickr": {
  "scope": ["write"]
}
"optimizely": {
  "scope": ["all"]
}
```


#### SurveyMonkey

Set your Mashery user name as `key` and your application key as `api_key`:

```js
"surveymonkey": {
  "key": "[MASHERY_USER_NAME]",
  "secret": "[CLIENT_SECRET]",
  "api_key": "[CLIENT_ID]"
}
```


#### Fitbit, LinkedIn, ProjectPlace

Initially these providers supported only OAuth1, so the `fitbit` and `linkedin` names are used for that. To use their OAuth2 flow append `2` at the end of their names:

```js
"fitbit2": {
  // then navigate to /connect/fitbit2
},
"linkedin2": {
  // then navigate to /connect/linkedin2
},
"projectplace2": {
  // then navigate to /connect/projectplace2
}
```


#### VisualStudio

Set your Client Secret as `secret` not the App Secret:

```js
"visualstudio": {
  "key": "[APP_ID]",
  "secret": "[CLIENT_SECRET not APP_SECRET]"
}
```


## Response Data

The OAuth response data is returned as querystring in your **final** callback - the one you specify in the `callback` key of your Grant configuration.

Alternatively the response data can be returned inside the session, see the [configuration][configuration] section above and the [session transport][session-transport-example] example.


#### OAuth1

For OAuth1 the `access_token` and the `access_secret` are accessible directly, `raw` contains the raw response data:

```js
{
  access_token: '...',
  access_secret: '...',
  raw: {
    oauth_token: '...',
    oauth_token_secret: '...',
    some: 'other data'
  }
}
```


#### OAuth2

For OAuth2 the `access_token` and the `refresh_token` (if present) are accessible directly, `raw` contains the raw response data:

```js
{
  access_token: '...',
  refresh_token: '...',
  raw: {
    access_token: '...',
    refresh_token: '...',
    some: 'other data'
  }
}
```


#### Error

In case of an error, the `error` key will be populated with the raw error data:

```js
{
  error: {
    some: 'error data'
  }
}
```


## Typical Flow

1. Register OAuth application on your provider's web site.
2. For `redirect` URL of your OAuth application **always** use this format:
  `[protocol]://[host]/connect/[provider]/callback`
3. Create `config.json` file containing:

  ```js
  "server": {
    "protocol": "https",
    "host": "mywebsite.com"
  },
  "facebook": {
    "key": "[CLIENT_ID]",
    "secret": "[CLIENT_SECRET]",
    "callback": "/handle_facebook_callback"
  },
  "twitter": {
    "key": "[CONSUMER_KEY]",
    "secret": "[CONSUMER_SECRET]",
    "callback": "/handle_twitter_callback"
  }
  ```
4. Initialize Grant and mount it:

  ```js
  // Express
  var express = require('express')
  var session = require('express-session')
  var grant = require('grant-express')
  express()
    .use(session({secret: 'grant'}))
    .use(grant(require('./config.json')))
  // or Koa
  // or Hapi
  ```
5. Navigate to `/connect/facebook` to initiate the OAuth flow for Facebook, or navigate to `/connect/twitter` to initiate the OAuth flow for Twitter.
6. Once the OAuth flow is completed you will receive the response data in the `/handle_facebook_callback` route for Facebook, and in the `/handle_twitter_callback` route for Twitter.

> Take a look at the [examples][grant-examples].


## Get User Profile

Once you have your access tokens secured, you can start making authorized requests on behalf of your users. **[Purest][purest]** is a generic REST API client library that supports **hundreds** of REST API providers.

For example, you may want to get the user's profile after the OAuth flow has completed:

```js
var request = require('request')
var purest = require('purest')({request})
var config = require('@purest/config')
var facebook = purest({provider: 'facebook', config})
var twitter = purest({provider: 'twitter', config,
  key: '[CONSUMER_KEY]', secret: '[CONSUMER_SECRET]'
})

facebook
  .get('me')
  .auth('[ACCESS_TOKEN]')
  .request((err, res, body) => {
    // here body is a parsed JSON object containing
    // id, first_name, last_name, gender, username, ...
  })

twitter
  .get('users/show')
  .qs({screen_name: 'nodejs'})
  .auth('[ACCESS_TOKEN]', '[ACCESS_SECRET]')
  .request((err, res, body) => {
    // here body is a parsed JSON object containing
    // id, screen_name, ...
  })
```


  [npm-version]: https://img.shields.io/npm/v/grant.svg?style=flat-square (NPM Version)
  [travis-ci]: https://img.shields.io/travis/simov/grant/master.svg?style=flat-square (Build Status)
  [coveralls-status]: https://img.shields.io/coveralls/simov/grant.svg?style=flat-square (Test Coverage)

  [npm]: https://www.npmjs.com/package/grant
  [travis]: https://travis-ci.org/simov/grant
  [coveralls]: https://coveralls.io/r/simov/grant?branch=master

  [grant-oauth]: https://grant.outofindex.com
  [purest]: https://github.com/simov/purest
  [purest-user]: https://github.com/simov/purest/blob/2.x/test/request/get.js
  [request]: https://github.com/request/request

  [oauth-config]: https://github.com/simov/grant/blob/master/config/oauth.json
  [reserved-keys]: https://github.com/simov/grant/blob/master/config/reserved.json
  [grant-examples]: https://github.com/simov/grant/tree/master/examples
  [session-transport-example]: https://github.com/simov/grant/blob/master/examples/session-transport/app.js

  [grant]: #grant
  [table-of-contents]: #table-of-contents
  [express]: #express
  [koa]: #koa
  [hapi]: #hapi
  [alternative-require]: #alternative-require
  [path-prefix]: #path-prefix
  [reserved-routes]: #reserved-routes
  [configuration]: #configuration
  [redirect-url]: #redirect-url
  [static-overrides]: #static-overrides
  [dynamic-override]: #dynamic-override
  [custom-parameters]: #custom-parameters
  [custom-providers]: #custom-providers
  [development-environments]: #development-environments
  [programmatic-access]: #programmatic-access
  [sandbox-redirect-uri]: #sandbox-redirect-uri
  [quirks]: #quirks
  [response-data]: #response-data
  [typical-flow]: #typical-flow
  [get-user-profile]: #get-user-profile
